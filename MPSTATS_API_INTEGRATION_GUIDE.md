# üîó –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –° MPSTATS API

## üéØ **–¶–µ–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –±—Ä–µ–Ω–¥–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** –∏–∑ MPStats API. –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω—ã –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

---

## üîë **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ MPStats API Token**

### **1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞**
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [https://mpstats.io](https://mpstats.io)
- –ü–æ–ª—É—á–∏—Ç–µ API —Ç–æ–∫–µ–Ω –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
- –¢–æ–∫–µ–Ω –∏–º–µ–µ—Ç —Ñ–æ—Ä–º–∞—Ç: `mp_xxx...` –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π

### **2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–µ**

#### **–ú–µ—Ç–æ–¥ 1: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
export MPSTATS_TOKEN="your-real-mpstats-token-here"
python main.py
```

#### **–ú–µ—Ç–æ–¥ 2: –í –∫–æ–¥–µ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)**
```python
# –í —Ñ–∞–π–ª–µ web-dashboard/backend/routes/brand_analysis.py
headers = {
    "X-Mpstats-TOKEN": "your-real-mpstats-token-here",
    "Content-Type": "application/json"
}
```

#### **–ú–µ—Ç–æ–¥ 3: .env —Ñ–∞–π–ª (–ø—Ä–æ–¥–∞–∫—à–Ω)**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ backend/
echo "MPSTATS_TOKEN=your-real-mpstats-token-here" > .env
```

---

## üìä **API Endpoints MPStats**

### **–û—Å–Ω–æ–≤–Ω–æ–π endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±—Ä–µ–Ω–¥–∞:**
```
GET https://mpstats.io/api/wb/get/brand
```

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|----------|---------|
| `d1` | –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ | `2023-10-01` |
| `d2` | –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ | `2023-11-01` |
| `path` | –ù–∞–∑–≤–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–∞ | `Mango` |
| `fbs` | –§–∏–ª—å—Ç—Ä FBS (0/1) | `0` |
| `newsmode` | –ù–æ–≤–∏–Ω–∫–∏ (0/7/14/30) | `30` |

### **–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```json
{
  "X-Mpstats-TOKEN": "your-token-here",
  "Content-Type": "application/json"
}
```

---

## üèóÔ∏è **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö MPStats**

### **–û—Ç–≤–µ—Ç API:**
```json
{
  "d1": "2023-10-01",
  "d2": "2023-11-01",
  "data": [
    {
      "id": "123456789",
      "name": "–¢–æ–≤–∞—Ä Example",
      "category": "–ö–∞—Ç–µ–≥–æ—Ä–∏—è/–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è",
      "final_price": 2500,
      "rating": 4.5,
      "sales": 150,
      "revenue": 375000,
      "balance": 200,
      "purchase": 85,
      "turnover_days": 30,
      "comments": 45,
      "sku_first_date": "2023-09-01",
      "url": "https://wildberries.ru/catalog/123456789/detail.aspx",
      "thumb_middle": "//images.wildberries.ru/tm/new/1234/123456789-1.jpg",
      
      "basic_sale": 15,
      "promo_sale": 5,
      "client_sale": 20,
      "start_price": 3000,
      "basic_price": 2800,
      "client_price": 2500,
      "category_position": 12,
      "country": "–¢—É—Ä—Ü–∏—è",
      "gender": "–∂–µ–Ω—Å–∫–∏–π",
      "picscount": 6,
      "hasvideo": true,
      "has3d": false,
      "is_fbs": true,
      
      "graph": [10, 15, 12, 18, 20, ...],
      "stocks_graph": [200, 190, 185, 180, ...],
      "price_graph": [2500, 2450, 2500, 2500, ...],
      "product_visibility_graph": [85, 90, 88, 92, ...]
    }
  ]
}
```

---

## üîß **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

### **–ö–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞:**

#### **401 Unauthorized**
```json
{"code": 401, "message": "Authorization Required"}
```
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å API —Ç–æ–∫–µ–Ω–∞

#### **404 Not Found**
```json
{"code": 404, "message": "Brand not found"}
```
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –±—Ä–µ–Ω–¥–∞

#### **408 Timeout**
**–ü—Ä–∏—á–∏–Ω–∞:** MPStats API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ

#### **500 Internal Server Error**
**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ MPStats
**–†–µ—à–µ–Ω–∏–µ:** –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É MPStats

---

## üéØ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞**
```bash
curl -H "X-Mpstats-TOKEN: your-token" \
     "https://mpstats.io/api/wb/get/brand?d1=2023-10-01&d2=2023-11-01&path=Mango"
```

### **2. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É**
```bash
curl -X POST "http://localhost:8000/brand/brand-analysis" \
  -H "Content-Type: application/json" \
  -d '{
    "brand_name": "Mango",
    "date_from": "2023-10-01",
    "date_to": "2023-11-01",
    "fbs": 0,
    "newsmode": 30
  }'
```

### **3. –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
‚úÖ **–£—Å–ø–µ—Ö (200):** –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—Ä–µ–Ω–¥–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
‚ùå **–û—à–∏–±–∫–∞ (401):** "MPStats API authorization failed"
‚ùå **–û—à–∏–±–∫–∞ (404):** "Brand 'BrandName' not found"

---

## üìã **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –±—Ä–µ–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

### **–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –±—Ä–µ–Ω–¥—ã –Ω–∞ Wildberries:**
- `Mango`
- `Zara`
- `H&M`
- `Adidas`
- `Nike`
- `LC Waikiki`
- `Gloria Jeans`
- `–¢–≤–æ–µ`
- `Befree`
- `O'stin`

---

## ‚öôÔ∏è **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**

### **1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
# –í production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
export MPSTATS_TOKEN="prod-token-here"
export ENVIRONMENT="production"
```

### **2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
```python
# –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ MPStats API –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
logger.info(f"üöÄ Fetching brand data for {brand_name}")
logger.info(f"üìä MPStats brand response: {response.status}")
```

### **3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–±—É–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è)**
```python
# –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:
# - Redis –∫—ç—à –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
# - TTL = 1 —á–∞—Å –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
# - –£–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ MPStats API
```

---

## üö® **–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**

### **1. –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã**
- ‚ùå –°–∏—Å—Ç–µ–º–∞ **–ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç** —Ñ–∞–ª—å—à–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –¢–æ–ª—å–∫–æ **—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ MPStats API
- ‚ö†Ô∏è –ü—Ä–∏ –æ—à–∏–±–∫–µ API - —á–µ—Ç–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

### **2. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic
- Graceful –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π

### **3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- Timeout –∑–∞–ø—Ä–æ—Å–æ–≤: 30 —Å–µ–∫—É–Ω–¥
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ aiohttp
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

### **–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ:**
```json
{
  "brand_info": {
    "name": "Mango",
    "total_products": 45,
    "total_revenue": 12500000,
    "total_sales": 2850,
    "average_price": 4385.50,
    "average_turnover_days": 28.5
  },
  "top_products": [...],
  "all_products": [...],
  "aggregated_charts": {
    "sales_graph": {"dates": [...], "values": [...]},
    "stocks_graph": {"dates": [...], "values": [...]},
    "price_graph": {"dates": [...], "values": [...]},
    "visibility_graph": {"dates": [...], "values": [...]}
  },
  "brand_metrics": {
    "products_with_sales_percentage": 82.2,
    "average_rating": 4.3,
    "total_comments": 1250,
    "fbs_percentage": 67.8
  },
  "metadata": {
    "data_source": "MPStats API",
    "processing_timestamp": "2025-07-19T13:45:00"
  }
}
```

### **–ü—Ä–∏ –æ—à–∏–±–∫–µ:**
```json
{
  "detail": "Brand 'UnknownBrand' not found. Please check the brand name and try again."
}
```

---

## üéâ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã**

### ‚úÖ **–ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- Backend API —Å MPStats –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- Frontend —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
- Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Graceful error handling

### üîß **–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:**
1. –î–µ–π—Å—Ç–≤—É—é—â–∏–π MPStats API —Ç–æ–∫–µ–Ω
2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `MPSTATS_TOKEN`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend —Å–µ—Ä–≤–µ—Ä–∞

### üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
**–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –±—Ä–µ–Ω–¥–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ MPStats!** 